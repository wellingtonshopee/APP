<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Status do Motorista</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilos personalizados para a página de status */
        body {
            font-family: 'Inter', sans-serif; /* Usando fonte Inter */
            background-color: #f3f4f6; /* Cor de fundo clara */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        .status-container {
            background-color: #ffffff; /* Fundo branco para o card */
            border-radius: 12px; /* Cantos arredondados */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Sombra suave */
            padding: 30px;
            width: 100%;
            max-width: 400px; /* Largura máxima reduzida para o card */
            text-align: left;
        }
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        .header img {
            max-width: 100px; /* Tamanho máximo para a logo */
            margin-bottom: 10px;
            /* Estilos para centralizar, cantos arredondados e sombra */
            display: block; /* Garante que a margem auto funcione */
            margin-left: auto;
            margin-right: auto;
            border-radius: 8px; /* Cantos arredondados (ajuste o valor se quiser mais/menos) */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Sombra */
            /* Mantendo a borda azul e padding se desejar, remova as duas linhas abaixo se não quiser */
            border: 3px solid #3b82f6;
            padding: 5px;
        }
        .header h1 {
            font-size: 1.8rem; /* Tamanho do título */
            font-weight: bold;
            color: #1f2937; /* Cor do título escura */
        }
        .info-block {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e5e7eb; /* Linha separadora */
        }
        .info-block:last-child {
            border-bottom: none; /* Remove a linha do último bloco */
            padding-bottom: 0;
            margin-bottom: 0;
        }
        .info-block strong {
            color: #4b5563; /* Cor para os rótulos */
            display: inline-block; /* Garante que o strong não quebre a linha antes do span */
            min-width: 120px; /* Largura mínima para alinhar rótulos */
        }
        .info-block span {
            color: #1f2937; /* Cor para os valores */
            font-weight: normal;
        }
        .status-indicator {
            font-size: 1.1rem;
            font-weight: bold;
            padding: 8px 15px;
            border-radius: 8px;
            text-align: center;
            margin-top: 20px;
        }
        .status-aguardando {
            background-color: #fcd34d; /* Amarelo */
            color: #78350f; /* Texto escuro */
        }
         .status-separacao { /* Novo status para Em Separação (1) */
            background-color: #60a5fa; /* Azul */
            color: #1e40af; /* Texto escuro */
        }
         .status-carregando-finalizado { /* Novo status para Carregamento Finalizado (2) */
            background-color: #34d399; /* Verde */
            color: #065f46; /* Texto escuro */
        }
         .status-concluido-status3 { /* Novo status para em_separacao = 3 */
            background-color: #a78bfa; /* Roxo (pode ajustar a cor) */
            color: #4c1d95; /* Texto escuro */
         }
        .status-liberado { /* Status Liberado (pode ser o mesmo que Carregamento Finalizado ou um novo) */
            background-color: #34d399; /* Verde */
            color: #065f46; /* Texto escuro */
        }
        .status-finalizado { /* Status Finalizado (finalizada = 1) */
            background-color: #a78bfa; /* Roxo */
            color: #4c1d95; /* Texto escuro */
        }
        .status-cancelado { /* Status Cancelado (cancelado = 1) */
            background-color: #f87171; /* Vermelho */
            color: #991b1b; /* Texto escuro */
        }
         .status-transferido { /* Novo status para Transferido (em_separacao = 4) */
            background-color: #d1d5db; /* Cinza */
            color: #4b5563; /* Texto escuro */
        }
        .error-message {
            color: #dc2626; /* Vermelho */
            font-weight: bold;
            text-align: center;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="status-container">
        <div class="header">
            <img src="{{ url_for('static', filename='imagem/shopito.png') }}" alt="Logo Shopito">
            <h1>Status do Motorista</h1>
        </div>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="flashes mb-4">
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }} text-center text-sm font-semibold px-4 py-2 rounded-md mb-2
                                    {% if category == 'success' %} bg-green-100 text-green-800 {% elif category == 'warning' %} bg-yellow-100 text-yellow-800 {% elif category == 'error' %} bg-red-100 text-red-800 {% else %} bg-blue-100 text-blue-800 {% endif %}">
                            {{ message }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        {% if motorista %}
            <div class="info-block">
                <strong>Matrícula:</strong> <span>{{ motorista.matricula or '-' }}</span>
            </div>
            <div class="info-block">
                <strong>Nome:</strong> <span>{{ motorista.nome or '-' }}</span>
            </div>
            <div class="info-block">
                <strong>Rota:</strong> <span>{{ motorista.rota or '-' }}</span>
            </div>
            <div class="info-block">
                <strong>Tipo de Entrega:</strong> <span>{{ motorista.tipo_entrega or '-' }}</span>
            </div>
            <div class="info-block">
                <strong>Cidade de Entrega:</strong> <span>{{ motorista.cidade_entrega or '-' }}</span>
            </div>
            {% if motorista.gaiola or motorista.estacao or motorista.rua %}
                <div class="info-block" id="gaiola-estacao-rua-block">
                    <strong>Gaiola:</strong> <span id="gaiola">{{ motorista.gaiola or '-' }}</span><br>
                    <strong>Estação:</strong> <span id="estacao">{{ motorista.estacao or '-' }}</span><br>
                    <strong>Rua:</strong> <span id="rua">{{ motorista.rua or '-' }}</span>
                </div>
            {% endif %}

            <div class="info-block">
                <strong>Login:</strong> <span>{{ motorista.data_hora_login | formata_data_hora or '-' }}</span>
            </div>

            <div id="status-indicator" class="status-indicator">
                {% if motorista.cancelado == 1 %}
                    <span class="status-cancelado">CANCELADO</span>
                {% elif motorista.em_separacao == 4 %} {# Verifica Transferido (No-Show) #}
                    <span class="status-transferido">TRANSFERIDO</span>
                {% elif motorista.em_separacao == 1 %} {# Verifica Em Separação #}
                    <span class="status-separacao">EM SEPARAÇÃO</span>
                {% elif motorista.em_separacao == 2 %} {# Verifica Carregamento Finalizado #}
                    <span class="status-carregando-finalizado">CARREGAMENTO FINALIZADO</span>
                {% elif motorista.em_separacao == 3 %} {# Verifica em_separacao = 3 #}
                    <span class="status-concluido-status3">CARREGAMENTO CONCLUÍDO (STATUS 3)</span> {# Novo texto de status #}
                {% elif motorista.finalizada == 1 %} {# Verifica Finalizado (geral) #}
                    <span class="status-finalizado">FINALIZADO</span>
                {% else %} {# em_separacao == 0 ou outro valor #}
                    <span class="status-aguardando">AGUARDANDO ASSOCIAÇÃO</span>
                {% endif %}
            </div>

             {% if motorista.finalizada == 1 or motorista.cancelado == 1 %}
                 <div class="info-block mt-4">
                     <strong>Hora de Finalização:</strong> <span>{{ motorista.hora_finalizacao | formata_data_hora or '-' }}</span>
                 </div>
            {% endif %}


        {% else %}
            <p class="error-message">{{ erro }}</p>
        {% endif %}

        <div class="text-center mt-6">
            <a href="{{ url_for('login') }}" class="text-blue-600 hover:underline">Voltar para o Login</a>
        </div>
    </div>
</body>
</html>
